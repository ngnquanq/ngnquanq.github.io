---
title: 'Paper Explained 6: Learning Diverse Image Colorization'
date: 2024-04-19
permalink: /posts/2024/04/blog-post-7/
tags:
  - Paper explained
published: true
---

**Image Colorization** ğŸ–Œï¸ lÃ  quÃ¡ trÃ¬nh dá»± Ä‘oÃ¡n mÃ u cho cÃ¡c áº£nh Ä‘en tráº¯ng, giÃºp tÃ¡i táº¡o láº¡i hÃ¬nh áº£nh thá»±c
táº¿ tá»« dá»¯ liá»‡u Ä‘Æ¡n sáº¯c, mang láº¡i tráº£i nghiá»‡m hÃ¬nh áº£nh phong phÃº vÃ  sá»‘ng Ä‘á»™ng. Vá»›i Ä‘áº§u vÃ o lÃ  má»™t áº£nh
xÃ¡m, biá»ƒu thá»‹ cÆ°á»ng Ä‘á»™ sÃ¡ng cá»§a áº£nh, mÃ´ hÃ¬nh sáº½ há»c cÃ¡ch Æ°á»›c tÃ­nh cÃ¡c kÃªnh mÃ u cá»§a áº£nh, táº¡o ra má»™t
hÃ¬nh áº£nh há»£p lÃ½ vÃ  hÃ i hÃ²a vá» máº·t thá»‹ giÃ¡c. Má»™t trong nhá»¯ng bÃ i mÃ  mÃ¬nh Ä‘Æ°á»£c há»c vá» chá»§ Ä‘á» nÃ y Ä‘Ã³ lÃ  bÃ i "Learning Diverse Image Colorization", má»i ngÆ°á»i cÃ³ thá»ƒ Ä‘á»c á»Ÿ [Ä‘Ã¢y](https://arxiv.org/pdf/1612.01958.pdf)

# Giá»›i thiá»‡u

Task tÃ´ mÃ u áº£nh thoáº¡t qua nghe hÆ¡i nháº£m (mÃ¬nh tháº¥y váº­y ğŸ˜), nhÆ°ng tháº­t ra cÃ³ nhiá»u á»©ng dá»¥ng cho Ä‘á»i sá»‘ng hÃ ng ngÃ y cá»§a chÃºng ta, sÆ¡ sÆ¡ qua thÃ¬ nÃ³ cÃ³ thá»ƒ lÃ m cho nhá»¯ng áº£nh tráº¯ng Ä‘en trong quÃ¡ khá»© cÃ³ mÃ u sáº¯c hÆ¡n, Ä‘á»‘i vá»›i lÄ©nh vá»±c ML&DL thÃ¬ cÅ©ng cÃ³ thá»ƒ coi nhÆ° viá»‡c tÃ´ mÃ u lÃ  má»™t cÃ¡ch Ä‘á»ƒ chÃºng ta tÄƒng cÆ°á»ng sá»‘ lÆ°á»£ng dá»¯ liá»‡u hiá»‡n cÃ³ (data augmentation) tháº­m chÃ­ á»Ÿ nhá»¯ng lÄ©nh vá»±c nhÆ° y khoa cÅ©ng sá»­ dá»¥ng tá»›i, nhÆ° lÃ  Ä‘á»ƒ tÄƒng cÆ°á»ng cÃ¡i sáº¯c Ä‘á»™, giÃºp cho cÃ¡c bÃ¡c sÄ© nhÃ¬n vÃ o dá»… chuáº©n Ä‘oÃ¡n hÆ¡n, vÃ  nhiá»u nhiá»u cÃ¡i khÃ¡c. ThÃ¬ cá»¥ thá»ƒ hÆ¡n, bÃ i toÃ¡n tÃ´ mÃ u áº£nh mÃ¬nh nháº¯c Ä‘áº¿n trong bÃ i nÃ y lÃ  nhÆ° sau:

![img_color](/assets/img/blog6/img_color.png){: .align-center}

Song, Ä‘Ã¢y váº«n lÃ  má»™t váº¥n Ä‘á» khÃ´ng dá»… Ä‘á»… tiáº¿p cáº­n, bá»Ÿi vÃ¬ cÃ³ ráº¥t nhiá»u cÃ¡ch Ä‘á»ƒ sinh ra nhiá»u mÃ u khÃ¡c nhau tá»« má»™t táº¥m áº£nh tráº¯ng Ä‘en, quan trá»ng á»Ÿ Ä‘Ã¢y lÃ  **mÃ u Ä‘Æ°á»£c tÃ´ cÃ³ nghÄ©a**, vÃ  ngoÃ i ra, theo nhÆ° paper (viáº¿t vÃ o nÄƒm 2017), táº¡i thá»i Ä‘iá»ƒm Ä‘Ã³, cÃ¡c phÆ°Æ¡ng phÃ¡p tÃ´ mÃ u áº£nh cÃ²n chÆ°a Ä‘Æ°á»£c tá»‘t cho láº¯m, bá»Ÿi vÃ¬ táº¡i thá»i Ä‘iá»ƒm Ä‘Ã³, cÃ¡c phÆ°Æ¡ng phÃ¡p cÅ© chá»‰ Ä‘Æ°a ra Ä‘Æ°á»£c gáº§n nhÆ° lÃ  1 káº¿t quáº£ duy nháº¥t (tá»©c lÃ  chá»‰ cÃ³ 1 táº¥m áº£nh mÃ u, nÃ³ khÃ´ng Ä‘a dáº¡ng láº¯m). 

Vá»›i cÃ¡i váº¥n Ä‘á» nhÆ° trÃªn, **goal cá»§a paper nÃ y lÃ  thiáº¿t káº¿ ra má»™t model cÃ³ kháº£ nÄƒng Ä‘a dáº¡ng áº£nh tÃ´ Ä‘Æ°á»£c tÃ´ mÃ u hÆ¡n (nhÆ°ng mÃ u tÃ´ váº«n pháº£i há»£p lÃ½)**

CÃ¡i hÃ¬nh dÆ°á»›i Ä‘Ã¢y mÃ¬nh bÃª tá»« cÃ¡i paper ra, há» lÃ m trÃªn bá»™ dá»¯ liá»‡u LFW ([Labeled Faces in the Wild](https://vis-www.cs.umass.edu/lfw/))

![result-img](/assets/img/blog6/result-paper.png)

VÃ­ dá»¥ nhÆ° máº¥y cÃ¡i hÃ¬nh nÃ y cá»§a ngÆ°á»i ta, nÃ³ Ä‘a dáº¡ng hÆ¡n háº³n nhá»¯ng cÃ¡i model sáºµn cÃ³ thá»i báº¥y giá», vÃ  má»i ngÆ°á»i lÆ°u Ã½ thÃªm lÃ  sáº½ **cÃ³ kháº£ nÄƒng ráº¥t cao nhá»¯ng sample Ä‘Æ°á»£c táº¡o ra khÃ´ng giá»‘ng ground truth**, nhÆ°ng **Ä‘Ã¢y khÃ´ng pháº£i váº¥n Ä‘á»**, mÃ¬nh sáº½ Ä‘á» cáº­p kÄ© hÆ¡n á»Ÿ nhá»¯ng pháº§n sau.

#### References: 
- Labeled Faces in the Wild - https://vis-www.cs.umass.edu/lfw/
- Learning Diverse Image Colorization - https://arxiv.org/pdf/1612.01958.pdf

# Ã tÆ°á»Ÿng 
Nhá»¯ng bÃ i toÃ¡n tÃ´ mÃ u áº£nh cÃ³ Ä‘iá»ƒm chung trong code Ä‘Ã³ chÃ­nh lÃ  chÃºng ta sáº½ cÃ³ má»™t **input lÃ  áº£nh tráº¯ng Ä‘en (grey-level image)** vÃ  **output lÃ  má»™t trÆ°á»ng 2 kÃªnh mÃ u** thÃ´ng qua má»™t hÃ m Ã¡nh xáº¡ nÃ o Ä‘Ã³. NhÆ° Ä‘á» cáº­p á»Ÿ trÃªn thÃ¬ sáº½ **cÃ³ vÃ´ sá»‘ áº£nh mÃ u khÃ¡c nhau cho cÃ¹ng má»™t áº£nh Ä‘en tráº¯ng**. KhÃ¡c nhau á»Ÿ Ä‘Ã¢y cÃ³ chÄƒng lÃ  á»Ÿ cÆ°á»ng Ä‘á»™ cá»§a mÃ u dá»± Ä‘oÃ¡n, vÃ­ dá»¥ nhÆ° má»™t cÃ¡i sáº½ cÃ³ mÃ u trá»i Ä‘áº­m hÆ¡n, cÃ¡i cÃ²n láº¡i cÃ³ áº£nh mÃ u trá»i nháº¡t hÆ¡n, v.v... Nghe thÃ¬ nhÆ° váº­y, nhá»¯ng phÆ°Æ¡ng phÃ¡p deep learning táº¡i thá»i Ä‘iá»ƒm Ä‘Ã³ cÃ³ váº» khÃ´ng Ä‘Æ°á»£c chuá»™ng cho láº¯m, song dÃ¹ sao, objective cá»§a bÃ i nghiÃªn cá»©u nÃ y lÃ  **táº¡o ra nhiá»u hÃ¬nh áº£nh Ä‘a dáº¡ng mÃ u sáº¯c, Ä‘á»“ng thá»i cÃ³ Ã½ nghÄ©a**. 

Váº¥n Ä‘á» náº±m á»Ÿ chá»— **má»™t trÆ°á»ng mÃ u nÃ o Ä‘Ã³ khÃ´ng chá»‰ phá»¥ thuá»™c vÃ o nhá»¯ng giÃ¡ trá»‹ lÃ¢n cáº­n, nÃ³ cÃ²n chá»‹u áº£nh hÆ°á»Ÿng bá»Ÿi cáº¥u trÃºc khÃ´ng gian (long-scale spatial structure)**, Ä‘iá»u nÃ y khiáº¿n cho viá»‡c sampling chá»‰ duy nháº¥t 1 Ä‘iá»ƒm áº£nh sáº½ lÃ m cho khu vá»±c lÃ¢n cáº­n Ä‘iá»ƒm áº£nh Ä‘Ã³ khÃ´ng Ä‘Æ°á»£c Äƒn khá»›p vá»›i nhau, lÃ m cho hÃ¬nh áº£nh khÃ´ng Ä‘Æ°á»£c thá»±c táº¿. Giáº£i phÃ¡p lÃ  **táº¡o ra Ä‘Æ°á»£c nhiá»u mÃ u khÃ¡c nhau nhÆ°ng pháº£i cÃ¢n báº±ng Ä‘Æ°á»£c giá»¯a Æ°á»›c lÆ°á»£ng cá»§a Ä‘iá»ƒm áº£nh Ä‘Ã³ vá»›i cÃ¡i cáº¥u trÃºc khÃ´ng gian áº£nh**. 

## Ã tÆ°á»Ÿng mÃ´ hÃ¬nh

Nhá»¯ng cÃ¡i á»Ÿ trÃªn Ä‘á» cáº­p cÃ³ thá»ƒ tÃ¡i hiá»‡n dÆ°á»›i cÃ´ng thá»©c toÃ¡n, mÃ´ hÃ¬nh chÃºng ta mong muá»‘n sáº½ lÃ  má»™t mÃ´ hÃ¬nh xÃ¡c suáº¥t $P(\mathbf{C|G})$ cho trÆ°á»ng mÃ u $C$ dá»±a trÃªn áº£nh xÃ¡m Ä‘áº§u vÃ o $G$ vÃ  sau Ä‘Ã³ Ä‘á»ƒ táº¡o ra, cháº³ng háº¡n N mÃ u khÃ¡c nhau Ä‘i, lÃºc nÃ y chÃºng ta sáº½ thá»±c hiá»‡n láº¥y máº«u cÃ³ tá»« phÃ¢n phá»‘i xÃ¡c suáº¥t vá»«a Ä‘á» cáº­p á»Ÿ trÃªn: 

$$
\begin{equation}
\{\mathbf{C}_k\}_{k=1}^{N} \sim P(\mathbf{C|G})
\end{equation}
$$

NhÆ°ng do nhá»¯ng cÃ¡i áº£nh thÆ°á»ng cÃ³ sá»‘ chiá»u ráº¥t cao, do Ä‘Ã³ phÃ¢n phá»‘i cá»§a cÃ¡c trÆ°á»ng áº£nh trong tá»± nhiÃªn vÃ  nhá»¯ng Ä‘áº·c trÆ°ng cá»§a áº£nh tráº¯ng Ä‘en trong khÃ´ng gian nhiá»u chiá»u bá»‹ phÃ¢n tÃ¡n. Hiá»ƒu Ä‘Æ¡n giáº£n Ä‘Ã¢y lÃ  má»™t trong nhá»¯ng hiá»‡n tiá»‡n cá»§a dá»¯ liá»‡u nhiá»u chiá»u, khi nÃ y khoáº£ng cÃ¡ch cá»§a 2 Ä‘iá»ƒm dá»¯ liá»‡u báº¥t ká»³ khÃ´ng cÃ²n nhiá»u Ã½ nghÄ©a khi sá»‘ chiá»u tÄƒng lÃªn, dáº«n Ä‘áº¿n cÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u cÃ³ phÃ¢n phá»‘i Ä‘á»u hÆ¡n trÃªn kháº¯p khÃ´ng gian dá»¯ liá»‡u. 

# Code

# Káº¿t quáº£

# Tháº£o luáº­n thÃªm


