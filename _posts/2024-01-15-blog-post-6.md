---
title: 'Paper Explained 4: Generative Adversarial Nets'
date: 2024-03-30
permalink: /posts/2024/03/blog-post-4/
tags:
  - Paper explained
  - Deep Learning
published: True
---

GAN lÃ  má»™t trong nhá»¯ng framework má»›i vÃ  tháº­t sá»± Ä‘á»™t phÃ¡ trong viá»‡c Æ°á»›c lÆ°á»£ng má»™t mÃ´ hÃ¬nh táº¡o sinh thÃ´ng qua quÃ¡ trÃ¬nh Ä‘á»‘i ngáº«u. Vá»›i Ã½ kiáº¿n cÃ¡ nhÃ¢n cá»§a mÃ¬nh thÃ¬ Ä‘Ã¢y lÃ  paper hay vÃ  khÃ¡ phá»©c táº¡p, vá»›i mÃ¬nh thÃ¬ paper nÃ y lÃ  mÃ´ hÃ¬nh generative Ä‘áº§u tiÃªn mÃ  mÃ¬nh lÃ m vÃ  tháº¥y nÃ³ cÅ©ng ra gÃ¬ ğŸ¤“ğŸ«°. So... Let's dive in! Má»i ngÆ°á»i cÃ³ thá»ƒ tÃ¬m Ä‘Æ°á»£c paper gá»‘c táº¡i [Ä‘Ã¢y](https://arxiv.org/pdf/1406.2661.pdf)

# Giá»›i thiá»‡u 

Paper nÃ y náº¿u nhÆ° má»i ngÆ°á»i lá»¥c láº¡i trÃªn arxiv thÃ¬ cÃ³ thá»ƒ tháº¥y nÃ³ Ä‘Æ°á»£c ra vÃ o thÃ¡ng 7 nÄƒm 2014. Theo nhÆ° nháº­n Ä‘á»‹nh cá»§a cÃ¡c tÃ¡c giáº£ vÃ o nÄƒm Ä‘Ã³ thÃ¬ cÃ³ thá»ƒ tháº¥y nhá»¯ng mÃ´ hÃ¬nh deep learning thá»i Ä‘Ã³ **cá»±c thá»‹nh lÃ  nhá»¯ng mÃ´ hÃ¬nh discriminative** (nÃ´m na lÃ  mÃ´ hÃ¬nh phÃ¢n loáº¡i) - lÃ  kiá»ƒu máº¥y cÃ¡i mÃ´ hÃ¬nh, hiá»ƒu Ä‘Æ¡n giáº£n lÃ  hÃ m Ã¡nh xáº¡ tá»« má»™t input cÃ³ sá»‘ chiá»u lá»›n sang má»™t ouput cÃ³ sá»‘ chiá»u nhá» hÆ¡n vÃ  thÆ°á»ng phá»¥c vá»¥ cho bÃ i toÃ¡n phÃ¢n loáº¡i, vÃ­ dá»¥ nhÆ° phÃ¢n loáº¡i chá»¯ sá»‘ viáº¿t tay v.v... 

VÃ  cÅ©ng thá»i Ä‘Ã³, cÃ¡c mÃ´ hÃ¬nh generative (táº¡o sinh) thÃ¬ láº¡i cÃ³ váº» Ã­t sÃ´i ná»•i hÆ¡n (nhÆ°ng giá» thÃ¬ sÃ´i ná»•i rá»“i - 2024). VÃ  cÅ©ng lÃºc nÃ y, cÃ¡c tÃ¡c giáº£ cá»§a paper nÃ y Ä‘Ã£ **propose má»™t framework má»›i**, má»™t framework hoáº¡t Ä‘á»™ng dá»±a trÃªn quÃ¡ trÃ¬nh Ä‘á»‘i ngáº«u (adversarial process - mÃ¬nh sáº½ giáº£i thÃ­ch á»Ÿ phÃ­a dÆ°á»›i). 

**Main Idea**: ChÃºng ta sáº½ huáº¥n luyá»‡n Ä‘á»“ng thá»i 2 mÃ´ hÃ¬nh, má»™t mÃ´ hÃ¬nh táº¡o sinh $G$ vÃ  má»™t mÃ´ hÃ¬nh phÃ¢n loáº¡i $D$. 2 mÃ´ hÃ¬nh nÃ y cÃ³ vai trÃ² khÃ¡c nhau. Äá»‘i vá»›i mÃ´ hÃ¬nh $G$, mÃ´ hÃ¬nh nÃ y sáº½ cá»‘ gáº¯ng **Æ°á»›c lÆ°á»£ng phÃ¢n phá»‘i cá»§a dá»¯ liá»‡u**. Trong khi Ä‘Ã³ Ä‘á»‘i vá»›i mÃ´ hÃ¬nh $D$, nÃ³ sáº½ **phÃ¢n loáº¡i xem má»™t sample nÃ o Ä‘Ã³ lÃ  Ä‘áº¿n tá»« $G$ hay Ä‘áº¿n tá»« bá»™ dá»¯ liá»‡u gá»‘c**. Mong muá»‘n cá»§a mÃ´ hÃ¬nh $G$ Ä‘Ã³ lÃ  cá»±c Ä‘áº¡i kháº£ nÄƒng mÃ´ hÃ¬nh $D$ Ä‘Æ°a ra má»™t káº¿t luáº­n sai (dÃ¢n dÃ£ hÆ¡n lÃ  $G$ pháº£i giá»i tá»›i má»©c mÃ  $D$ khÃ´ng phÃ¡t hiá»‡n Ä‘Æ°á»£c sample Ä‘i ra tá»« $G$ lÃ  giáº£ hay tháº­t). CÃ²n $D$ lÃºc chÃºng ta huáº¥n luyá»‡n thÃ¬ Ä‘Æ°Æ¡ng nhiÃªn lÃºc nÃ o chÃºng ta cÅ©ng muá»‘n $D$ phÃ¢n biá»‡t Ä‘Æ°á»£c rá»“i (dÃ¢n dÃ£ hÆ¡n lÃ  $D$ cÅ©ng pháº£i Ä‘á»§ trÃ¬nh Ä‘á»ƒ lÃºc nÃ o cÅ©ng check var Ä‘Æ°á»£c tháº±ng e $G$). Do Ä‘Ã³ cÃ³ thá»ƒ tháº¥y framework nÃ y lÃ  thuá»™c dáº¡ng minimax two-player game. 

NhÆ° váº­y, thá»© mÃ  chÃºng ta mong muá»‘n trong quÃ¡ trÃ¬nh train (theo lÃ½ thuyáº¿t) lÃ  nhÆ° sau: $G$ cÃ³ thá»ƒ Æ°á»›c lÆ°á»£ng Ä‘Æ°á»£c phÃ¢n phá»‘i cá»§a bá»™ dá»¯ liá»‡u (Æ°á»›c lÆ°á»£ng chÃ­nh xÃ¡c) vÃ  output cá»§a $D$ luÃ´n lÃ  $0.5$. 

# Ã tÆ°á»Ÿng chÃ­nh

Há»“i nÃ y á»Ÿ Ä‘oáº¡n trÃªn mÃ¬nh Ä‘Ã£ cÃ³ Ä‘á» cáº­p vá» cÃ¡i main idea cá»§a cÃ¡i framework nÃ y, bÃ¢y giá» mÃ¬nh sáº½ nÃ³i cá»¥ thá»ƒ hÆ¡n (vá»›i vÃ­ dá»¥ ğŸ‘½).

Giáº£ sá»­ Ä‘ang cÃ³ 2 phe, má»™t phe lÃ m tiá»n giáº£ (Generator ğŸ’µ) vÃ  má»™t phe lÃ m cáº£nh sÃ¡t (Police ğŸ‘®). Phe lÃ m tiá»n giáº£ Ä‘ang cá»‘ gáº¯ng **lÃ m tiá»n giáº£ Ä‘á»ƒ qua máº·t cáº£nh sÃ¡t** vÃ  lÆ°u thÃ´ng lÆ°á»£ng tiá»n giáº£ Ä‘Ã³ ngoÃ i thá»‹ trÆ°á»ng, cÃ²n phe cáº£nh sÃ¡t thÃ¬ láº¡i khÃ´ng muá»‘n lÆ°á»£ng tiá»n giáº£ Ä‘Ã³ lÆ°u thÃ´ng ngoÃ i thá»‹ trÆ°á»ng nÃªn má»›i láº­p **má»™t team Ä‘á»ƒ phÃ¡t hiá»‡n tiá»n giáº£**. Tá»›i Ä‘Ã¢y lÃ  má»i ngÆ°á»i Ä‘Ã£ tháº¥y cÃ³ sá»± Ä‘á»‘i nghá»‹ch vá»›i nhau rá»“i, chá»¯ `Adversarial` cÅ©ng tá»« Ä‘Ã¢y mÃ  ra. 

Giá» vÃ­ dá»¥ cuá»™c Ä‘á»¥ng Ä‘á»™ nÃ y lÃ  dÃ i vÃ´ háº¡n (tá»©c lÃ  náº¿u khÃ´ng cÃ³ gÃ¬ tÃ¡c Ä‘á»™ng thÃ¬ 2 bÃªn váº«n Ä‘Æ¡m nhau). ThÃ¬ á»Ÿ thá»i Ä‘iá»ƒm xuáº¥t phÃ¡t ($t=0$), bÃªn lÃ m tiá»n giáº£ tung ra má»™t lÃ´ tiá»n giáº£, vÃ  cÃ¡c anh cáº£nh sÃ¡t pháº£i gom Ä‘Æ°á»£c cÃ¡i lÃ´ Ä‘Ã³, nhÆ°ng cÃ¡i váº¥n Ä‘á» á»Ÿ Ä‘Ã¢y lÃ  do Ä‘Ã¢y lÃ  láº§n Ä‘áº§u tiÃªn cáº£ 2 lÃ m nhá»¯ng viá»‡c nhÆ° váº­y cho nÃªn há» chÆ°a giá»i. NhÆ° váº­y, sau khi cÃ¡i máº¥y anh cáº£nh sÃ¡t báº¯t Ä‘Æ°á»£c máº¥y lÃ´ tiá»n giáº£, máº¥y anh lÃ m tiá»n giáº£ lÃºc nÃ y má»›i tháº¥y khÃ´ng á»•n, nÃªn lÃ  há» cáº­p nháº­t láº¡i trÃ¬nh Ä‘á»™, rá»“i lÃ m tiá»n giáº£ tá»‘t hÆ¡n. Máº¥y anh cáº£nh sÃ¡t cÅ©ng khÃ´ng chá»‹u Ä‘á»ƒ yÃªn, lÃºc nÃ y máº¥y áº£nh má»›i cáº§m cÃ¡i Ä‘á»‘ng tiá»n giáº£ Ä‘Ã³ Ä‘á»ƒ há»c rá»“i xÃ¡c Ä‘á»‹nh xem cÃ¡i nÃ o má»›i lÃ  giáº£, cÃ¡i nÃ o má»›i lÃ  tháº­t, tá»« Ä‘Ã³ máº¥y áº£nh phÃ¡t hiá»‡n tiá»n giáº£ tá»‘t hÆ¡n. 

VÃ  cá»© nhÆ° váº­y, cho tá»›i má»™t thá»i Ä‘iá»ƒm $t = T$ vá»›i T ráº¥t lá»›n nÃ o Ä‘Ã³, phe lÃ m tiá»n giáº£ Ä‘Ã£ cÃ³ Ä‘á»§ ká»¹ nÄƒng Ä‘á»ƒ lÃ m tiá»n giáº£ y xÃ¬ Ä‘Ãºc tiá»n thiá»‡t, cÃ²n bÃªn cáº£nh sÃ¡t thÃ¬ Ä‘Ã£ Ä‘áº¡t tá»›i giá»›i háº¡n rá»“i, bá»Ÿi vÃ¬ nhÃ¬n tá» tiá»n nÃ o cÅ©ng giá»‘ng nhau (bÃªn tiá»n giáº£ lÃ m tiá»n giáº£ quÃ¡ tá»‘t) nÃªn lÃºc nÃ y, káº¿t quáº£ tiá»n giáº£ vÃ  tiá»n thiá»‡t lÃºc nÃ o cÅ©ng lÃ  50%. 

# Code

á» Ä‘Ã¢y thÃ¬ mÃ¬nh sáº½ thá»±c hiá»‡n trÃªn bá»™ MNIST (bá»™ nÃ y nháº¹, vÃ  cÃ³ hÃ m Ä‘á»ƒ gá»i tháº³ng luÃ´n). 


# Æ¯u vÃ  nhÆ°á»£c Ä‘iá»ƒm cá»§a framework
Æ¯u Ä‘iá»ƒm:
- **Kháº£ nÄƒng há»c khÃ´ng giÃ¡m sÃ¡t**: GANs cÃ³ thá»ƒ há»c Ä‘á»ƒ táº¡o ra dá»¯ liá»‡u mÃ  khÃ´ng cáº§n nhÃ£n, Ä‘iá»u nÃ y má»Ÿ ra kháº£ nÄƒng á»©ng dá»¥ng trong nhiá»u lÄ©nh vá»±c mÃ  dá»¯ liá»‡u cÃ³ nhÃ£n lÃ  khan hiáº¿m.
- **Cháº¥t lÆ°á»£ng cao**: Dá»¯ liá»‡u Ä‘Æ°á»£c táº¡o ra bá»Ÿi GANs thÆ°á»ng cÃ³ cháº¥t lÆ°á»£ng cao vÃ  ráº¥t giá»‘ng vá»›i dá»¯ liá»‡u thá»±c, Ä‘áº·c biá»‡t lÃ  trong lÄ©nh vá»±c sinh áº£nh.
- **á»¨ng dá»¥ng Ä‘a dáº¡ng**: Tá»« viá»‡c táº¡o áº£nh, video giáº£ máº¡o Ä‘áº¿n viá»‡c táº¡o dá»¯ liá»‡u huáº¥n luyá»‡n cho cÃ¡c mÃ´ hÃ¬nh khÃ¡c, GANs Ä‘Ã£ má»Ÿ ra nhiá»u hÆ°á»›ng á»©ng dá»¥ng má»›i trong AI.

NhÆ°á»£c Ä‘iá»ƒm:
- **KhÃ³ huáº¥n luyá»‡n**: Viá»‡c cÃ¢n báº±ng giá»¯a mÃ´ hÃ¬nh sinh vÃ  mÃ´ hÃ¬nh phÃ¢n biá»‡t lÃ  má»™t thÃ¡ch thá»©c lá»›n, dá»… dáº«n Ä‘áº¿n tÃ¬nh tráº¡ng mÃ´ hÃ¬nh khÃ´ng há»™i tá»¥.
- **Mode collapse**: ÄÃ¢y lÃ  hiá»‡n tÆ°á»£ng mÃ  mÃ´ hÃ¬nh sinh chá»‰ táº¡o ra má»™t sá»‘ lÆ°á»£ng háº¡n cháº¿ cÃ¡c máº«u, lÃ m giáº£m Ä‘a dáº¡ng cá»§a dá»¯ liá»‡u Ä‘Æ°á»£c táº¡o ra.
- **KhÃ´ng cÃ³ Ä‘áº£m báº£o vá» tÃ­nh chÃ­nh xÃ¡c**: Máº·c dÃ¹ dá»¯ liá»‡u táº¡o ra cÃ³ thá»ƒ trÃ´ng ráº¥t thá»±c, nhÆ°ng khÃ´ng cÃ³ Ä‘áº£m báº£o ráº±ng nÃ³ tuÃ¢n theo phÃ¢n phá»‘i dá»¯ liá»‡u thá»±c sá»±.

# Tháº£o luáº­n thÃªm